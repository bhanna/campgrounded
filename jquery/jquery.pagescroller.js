var pageScroller={};(function($){$.fn.extend({pageScroller:function(options){var defaults={currentSection:0,sectionClass:'section',linkClass:'link',navigation:new Array(),navigationClass:'standardNav dark',navigationLabel:'Navigation',animationSpeed:500,animationType:'swing',scrollOffset:0,HTML5mode:false,deepLink:false,keyboardControl:true,animationBefore:function(){},animationComplete:function(){},onChange:function(){}}
var options=$.extend(defaults,options);pageScroll=function(pageScroll,o){$.fx.interval=5;pageScroller.scrollDocument=$(document);pageScroller.scrollWindow=$(window);pageScroller.scrollBody=$("body");pageScroller.scrollPosition=pageScroller.scrollWindow.scrollTop();pageScroller.currentSectionHeight=pageScroller.scrollWindow.height();pageScroller.options=o;pageScroller.options.scrollOffset=parseInt(pageScroller.options.scrollOffset);var navWrapper="div";if(o.HTML5mode)navWrapper="nav";if(pageScroller.options.navigation instanceof Array){pageScroll.append('<'+navWrapper+' class="pageScrollerNav '+o.navigationClass+'"><ul></ul></'+navWrapper+'>');pageScroller.wrapper=$('.'+o.navigationClass.replace(/\s/g,'.'),pageScroll);pageScroller.navigation=$('ul',pageScroller.wrapper);pageScroller.wrapper.addClass('left');pageScroll.css({position:'relative'});}
if(o.HTML5mode){pageScroller.sections=$('section',pageScroll);}else{pageScroller.sections=$('.'+o.sectionClass,pageScroll);}
pageScroller.sections.each(function(index){var section=$(this);var sectionTitle=pageScroller.sections.eq(index).attr('title');var linkClass=o.linkClass+' '+o.linkClass+'_'+(index+1);if(index==pageScroller.sections.length-1)linkClass+=' '+o.linkClass+'_last';section.css({display:'block',position:'relative',float:'none'});section.addClass(pageScroller.options.sectionClass+'_'+(index+1));if(pageScroller.options.navigation instanceof Array){if(pageScroller.options.navigation.length){pageScroller.navigation.append('<li class="'+linkClass+'"><a href="#pageScroll'+index+'">'+pageScroller.options.navigation[index]+'</a></li>');}else if(sectionTitle&&sectionTitle!=''){pageScroller.navigation.append('<li class="'+linkClass+'"><a href="#pageScroll'+index+'">'+sectionTitle+'</a></li>');}else{pageScroller.navigation.append('<li class="'+linkClass+'"><a href="#pageScroll'+index+'">Navigation '+(index+1)+'</a></li>');}}else{pageScroller.navigation=$(pageScroller.options.navigation);}});pageScroller.pageLinks=$('a',pageScroller.navigation);pageScroller.pageLinks.each(function(index){$(this).bind('click',function(e){e.preventDefault();o.animationBefore();if(!pageScroller.scrollBody.is(':animated')){pageScroller.pageLinks.parent('li').removeClass('active');$(this).parent('li').addClass('active');}
scrollPageTo(pageScroll,pageScroller.sections.eq(index),index);});});pageScroller.next=function(){next(pageScroll,pageScroller.options.currentSection);}
pageScroller.prev=function(){prev(pageScroll,pageScroller.options.currentSection);}
pageScroller.goTo=function(index){goTo(pageScroll,pageScroller.options.currentSection,index);}
if(pageScroller.options.keyboardControl){pageScroller.scrollDocument.bind('keydown',function(e){var key=e.which?e.which:e.keyCode;if(key==38||key==40){e.preventDefault();if(key==38){if(!pageScroller.options.currentSection){pageScroller.goTo(pageScroller.options.currentSection+1);}else{pageScroller.goTo(pageScroller.options.currentSection);}}else if(key==40){if(pageScroller.options.currentSection+1==pageScroller.sections.length){pageScroller.goTo(pageScroller.options.currentSection+1);}else{pageScroller.goTo(pageScroller.options.currentSection+2);}}}});}
pageScroller.scrollWindow.bind('scroll',function(e){findPosition();});setTimeout(function(){if(pageScroller.scrollPosition==0)getHashTag();findPosition();},200);}
var getHashTag=function(){if(pageScroller.options.deepLink){var hashTag=window.location.hash;if(hashTag){pageScroller.pageLinks.each(function(index){var checkHash=pageScroller.pageLinks.eq(index).html();checkHash=checkHash.replace(/[^a-zA-Z 0-9]+/g,'').replace(/\s+/g,'-').toLowerCase();checkHash='#section-'+checkHash;if(hashTag==checkHash){pageScroller.goTo(index+1);return false;}});}}}
var findPosition=function(){pageScroller.scrollPosition=pageScroller.scrollWindow.scrollTop();pageScroller.scrollDistance=pageScroller.scrollPosition+pageScroller.currentSectionHeight;for(i=0;i<pageScroller.sections.length;i++){var section=pageScroller.sections.eq(i);var sectionTop=section.offset().top;if(pageScroller.options.scrollOffset&&sectionTop){sectionTop+=pageScroller.options.scrollOffset;}
var nextSectionTop=0;if(i<pageScroller.sections.length-1){var nextSection=pageScroller.sections.eq(i+1);if(pageScroller.options.scrollOffset){nextSectionTop=nextSection.offset().top+pageScroller.options.scrollOffset;}else{nextSectionTop=nextSection.offset().top;}
var currentLink=pageScroller.pageLinks.eq(i).parent('li');var lastLink=pageScroller.pageLinks.eq(pageScroller.sections.length-1).parent('li');}
if(!pageScroller.scrollBody.is(':animated')){if(pageScroller.scrollDocument.height()==pageScroller.scrollDistance){if(!lastLink.hasClass('active')){updateTo=pageScroller.sections.length-1;updateNav(updateTo);return false;}}else if(nextSectionTop){if(pageScroller.scrollPosition>=sectionTop&&pageScroller.scrollPosition<nextSectionTop){if(!currentLink.hasClass('active')){updateTo=i;updateNav(updateTo);return false;}}}else if(pageScroller.scrollPosition>=sectionTop&&i==pageScroller.sections.length-1){if(!lastLink.hasClass('active')){updateTo=pageScroller.sections.length-1;updateNav(updateTo);return false;}}}else{return false;}}}
var scrollPageTo=function(pageScroll,targetSection,index){var page=$("html, body");var scrollWindow=$(window);var pageTop=scrollWindow.scrollTop();targetSection=targetSection.offset().top;if(pageScroller.options.scrollOffset)targetSection+=pageScroller.options.scrollOffset;if(targetSection<0)targetSection=0;if(targetSection!=pageTop&&!page.is(':animated')){page.animate({scrollTop:targetSection},pageScroller.options.animationSpeed,pageScroller.options.animationType).promise().done(function(){updateNav(index);pageScroller.options.animationComplete();});}}
var addHashTag=function(index){var myLink=pageScroller.pageLinks.eq(index).html();myLink=myLink.replace(/[^a-zA-Z 0-9]+/g,'').replace(/\s+/g,'-').toLowerCase();window.location.hash='section-'+myLink;}
var updateNav=function(index){pageScroller.pageLinks.parent('li').removeClass('active');pageScroller.pageLinks.eq(index).parent('li').addClass('active');pageScroller.options.currentSection=index;if(pageScroller.options.deepLink){addHashTag(index);}
pageScroller.options.onChange();}
var next=function(pageScroll,o){var index=o+1;if(index!=pageScroller.sections.length){var targetSection=pageScroller.sections.eq(index);scrollPageTo(pageScroll,targetSection,index);}}
var prev=function(pageScroll,o){var index=o-1;if(index<=0)index=0;var targetSection=pageScroller.sections.eq(index);scrollPageTo(pageScroll,targetSection,index);}
var goTo=function(pageScroll,o,index){index=index-1;var targetSection=pageScroller.sections.eq(index);scrollPageTo(pageScroll,targetSection,index);}
if(!pageScroller.options){return pageScroll(this,options);}}});})(jQuery);